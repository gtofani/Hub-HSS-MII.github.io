<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Divisi HSS2 - PT.MII</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .hover-scale {
            transition: transform 0.2s;
        }
        .hover-scale:hover {
            transform: scale(1.02);
        }
        .sidebar-item {
            transition: all 0.3s ease;
        }
        .sidebar-item:hover {
            background-color: rgba(59, 130, 246, 0.1);
            border-left: 4px solid #3b82f6;
        }
        .file-card {
            transition: all 0.3s ease;
        }
        .file-card:hover {
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Loading Screen -->
    <div id="loadingScreen" class="fixed inset-0 bg-white z-50 flex items-center justify-center">
        <div class="text-center">
            <i class="fas fa-cog fa-spin text-6xl text-blue-600 mb-4"></i>
            <p class="text-gray-600">Memuat sistem...</p>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-600 to-purple-700">
        <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md fade-in">
            <div class="text-center mb-8">
                <i class="fas fa-book-open text-5xl text-blue-600 mb-4"></i>
                <h1 class="text-3xl font-bold text-gray-800">Divisi HSS2</h1>
                <p class="text-gray-600 mt-2">PT. MII - Ebook & Dokumentasi</p>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                    <input type="text" id="loginUsername" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Masukkan username" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="loginPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Masukkan password" required>
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition duration-200 font-medium">
                    <i class="fas fa-sign-in-alt mr-2"></i>Login
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">Belum punya akun?</p>
                <button onclick="showRegistration()" class="text-blue-600 hover:text-blue-700 font-medium mt-2">
                    <i class="fas fa-user-plus mr-1"></i>Registrasi
                </button>
            </div>
        </div>
    </div>

    <!-- Registration Screen -->
    <div id="registrationScreen" class="min-h-screen flex items-center justify-center bg-gradient-to-br from-green-600 to-blue-700 hidden">
        <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md fade-in">
            <div class="text-center mb-8">
                <i class="fas fa-user-plus text-5xl text-green-600 mb-4"></i>
                <h1 class="text-3xl font-bold text-gray-800">Registrasi Anggota</h1>
            </div>
            
            <form id="registrationForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                    <input type="text" id="regUsername" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="Buat username" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="regPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="Buat password" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Divisi HSS2</label>
                    <select id="regDivision" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" required>
                        <option value="">Pilih Divisi HSS2</option>
                        <option value="HSS2-Mechanical">HSS2-Mechanical</option>
                        <option value="HSS2-Electrical">HSS2-Electrical</option>
                        <option value="HSS2-Instrumentation">HSS2-Instrumentation</option>
                        <option value="HSS2-Civil">HSS2-Civil</option>
                        <option value="HSS2-Safety">HSS2-Safety</option>
                        <option value="HSS2-Quality">HSS2-Quality</option>
                    </select>
                </div>
                <button type="submit" class="w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition duration-200 font-medium">
                    <i class="fas fa-user-check mr-2"></i>Registrasi
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <button onclick="showLogin()" class="text-gray-600 hover:text-gray-700">
                    <i class="fas fa-arrow-left mr-1"></i>Kembali ke Login
                </button>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="hidden">
        <!-- Sidebar -->
        <div class="fixed left-0 top-0 h-full w-64 bg-white shadow-lg z-40">
            <div class="p-6 border-b">
                <div class="flex items-center">
                    <i class="fas fa-book-open text-3xl text-blue-600 mr-3"></i>
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Divisi HSS2</h2>
                        <p class="text-sm text-gray-600">PT. MII</p>
                    </div>
                </div>
            </div>
            
            <nav class="mt-6">
                <div class="px-4 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wider">Menu Utama</div>
                <a href="#" onclick="showDashboard()" class="sidebar-item flex items-center px-6 py-3 text-gray-700 hover:text-blue-600">
                    <i class="fas fa-home w-5 mr-3"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" onclick="showEbooks()" class="sidebar-item flex items-center px-6 py-3 text-gray-700 hover:text-blue-600">
                    <i class="fas fa-book w-5 mr-3"></i>
                    <span>Ebook & Knowledge Base</span>
                </a>
                <a href="#" onclick="showDocumentation()" class="sidebar-item flex items-center px-6 py-3 text-gray-700 hover:text-blue-600">
                    <i class="fas fa-folder-open w-5 mr-3"></i>
                    <span>Dokumentasi</span>
                </a>
                <a href="#" onclick="showActivities()" class="sidebar-item flex items-center px-6 py-3 text-gray-700 hover:text-blue-600">
                    <i class="fas fa-calendar-alt w-5 mr-3"></i>
                    <span>Aktivitas Anggota</span>
                </a>
                
                <div class="px-4 py-2 mt-6 text-xs font-semibold text-gray-400 uppercase tracking-wider">Admin</div>
                <a href="#" onclick="showUserManagement()" class="sidebar-item flex items-center px-6 py-3 text-gray-700 hover:text-blue-600" id="adminMenu" style="display: none;">
                    <i class="fas fa-users-cog w-5 mr-3"></i>
                    <span>Manajemen User</span>
                </a>
            </nav>
            
            <div class="absolute bottom-0 w-full p-4 border-t">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <i class="fas fa-user-circle text-2xl text-gray-600 mr-3"></i>
                        <div>
                            <p class="text-sm font-medium text-gray-800" id="currentUser">-</p>
                            <p class="text-xs text-gray-600" id="currentDivision">-</p>
                        </div>
                    </div>
                    <button onclick="logout()" class="text-red-600 hover:text-red-700">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="ml-64 p-8">
            <!-- Dashboard -->
            <div id="dashboardContent" class="fade-in">
                <h1 class="text-3xl font-bold text-gray-800 mb-8">Dashboard</h1>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white rounded-xl shadow-md p-6 hover-scale">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Total Anggota</p>
                                <p class="text-2xl font-bold text-gray-800" id="totalEngineers">0</p>
                            </div>
                            <i class="fas fa-users text-3xl text-blue-600"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-md p-6 hover-scale">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Total Ebook</p>
                                <p class="text-2xl font-bold text-gray-800" id="totalEbooks">0</p>
                            </div>
                            <i class="fas fa-book text-3xl text-green-600"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-md p-6 hover-scale">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Total Dokumentasi</p>
                                <p class="text-2xl font-bold text-gray-800" id="totalDocs">0</p>
                            </div>
                            <i class="fas fa-file-alt text-3xl text-purple-600"></i>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-md p-6 hover-scale">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm">Divisi HSS2</p>
                                <p class="text-2xl font-bold text-gray-800" id="totalDivisions">0</p>
                            </div>
                            <i class="fas fa-building text-3xl text-orange-600"></i>
                        </div>
                    </div>
                </div>

                <!-- Recent Activities -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Aktivitas Terbaru</h2>
                    <div id="recentActivities" class="space-y-3">
                        <!-- Activities will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Ebooks Content -->
            <div id="ebooksContent" class="fade-in hidden">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-800">Ebook & Knowledge Base</h1>
                    <button onclick="showCreateEbook()" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition duration-200">
                        <i class="fas fa-plus mr-2"></i>Buat Ebook
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="ebooksList">
                    <!-- Ebooks will be populated here -->
                </div>
            </div>

            <!-- Documentation Content -->
            <div id="documentationContent" class="fade-in hidden">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-800">Dokumentasi Instalasi</h1>
                    <button onclick="showUploadDoc()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition duration-200">
                        <i class="fas fa-upload mr-2"></i>Upload Dokumentasi
                    </button>
                </div>
                
                <div class="mb-6">
                    <select id="divisionFilter" onchange="filterDocumentation()" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <option value="">Semua Divisi HSS2</option>
                        <option value="HSS2-Mechanical">HSS2-Mechanical</option>
                        <option value="HSS2-Electrical">HSS2-Electrical</option>
                        <option value="HSS2-Instrumentation">HSS2-Instrumentation</option>
                        <option value="HSS2-Civil">HSS2-Civil</option>
                        <option value="HSS2-Safety">HSS2-Safety</option>
                        <option value="HSS2-Quality">HSS2-Quality</option>
                    </select>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6" id="documentationList">
                    <!-- Documentation will be populated here -->
                </div>
            </div>

            <!-- Activities Content -->
            <div id="activitiesContent" class="fade-in hidden">
                <h1 class="text-3xl font-bold text-gray-800 mb-8">Aktivitas Anggota</h1>
                
                <div class="bg-white rounded-xl shadow-md p-6">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b">
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Tanggal</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Anggota</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Divisi HSS2</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Aktivitas</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Detail</th>
                                </tr>
                            </thead>
                            <tbody id="activitiesTable">
                                <!-- Activities will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- User Management (Admin Only) -->
            <div id="userManagementContent" class="fade-in hidden">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-800">Manajemen User</h1>
                    <button onclick="showAddUser()" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition duration-200">
                        <i class="fas fa-user-plus mr-2"></i>Tambah User
                    </button>
                </div>
                
                <div class="bg-white rounded-xl shadow-md p-6">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b">
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Username</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Divisi HSS2</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Role</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Status</th>
                                    <th class="text-left py-3 px-4 font-semibold text-gray-700">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="usersTable">
                                <!-- Users will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Create Ebook -->
    <div id="createEbookModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white rounded-xl p-8 w-full max-w-2xl">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Buat Ebook Baru</h2>
            <form id="createEbookForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Judul Ebook</label>
                    <input type="text" id="ebookTitle" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Kategori</label>
                    <select id="ebookCategory" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                        <option value="">Pilih Kategori</option>
                        <option value="Technical">Technical</option>
                        <option value="Procedure">Procedure</option>
                        <option value="Manual">Manual</option>
                        <option value="Guideline">Guideline</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="ebookDescription" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Upload File (MS Word)</label>
                    <input type="file" id="ebookFile" accept=".doc,.docx" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="flex justify-end space-x-4">
                    <button type="button" onclick="closeModal('createEbookModal')" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50">Batal</button>
                    <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Upload Documentation -->
    <div id="uploadDocModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white rounded-xl p-8 w-full max-w-2xl">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Upload Dokumentasi</h2>
            <form id="uploadDocForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Judul Dokumentasi</label>
                    <input type="text" id="docTitle" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Divisi HSS2</label>
                    <select id="docDivision" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" required>
                        <option value="">Pilih Divisi HSS2</option>
                        <option value="HSS2-Mechanical">HSS2-Mechanical</option>
                        <option value="HSS2-Electrical">HSS2-Electrical</option>
                        <option value="HSS2-Instrumentation">HSS2-Instrumentation</option>
                        <option value="HSS2-Civil">HSS2-Civil</option>
                        <option value="HSS2-Safety">HSS2-Safety</option>
                        <option value="HSS2-Quality">HSS2-Quality</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="docDescription" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" required></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Upload File</label>
                    <input type="file" id="docFile" accept=".pdf,.doc,.docx,.jpg,.png" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" required>
                </div>
                <div class="flex justify-end space-x-4">
                    <button type="button" onclick="closeModal('uploadDocModal')" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50">Batal</button>
                    <button type="submit" class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700">Upload</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Add User (Admin) -->
    <div id="addUserModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white rounded-xl p-8 w-full max-w-md">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Tambah User Baru</h2>
            <form id="addUserForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                    <input type="text" id="newUsername" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="newPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Divisi HSS2</label>
                    <select id="newDivision" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" required>
                        <option value="">Pilih Divisi HSS2</option>
                        <option value="HSS2-Mechanical">HSS2-Mechanical</option>
                        <option value="HSS2-Electrical">HSS2-Electrical</option>
                        <option value="HSS2-Instrumentation">HSS2-Instrumentation</option>
                        <option value="HSS2-Civil">HSS2-Civil</option>
                        <option value="HSS2-Safety">HSS2-Safety</option>
                        <option value="HSS2-Quality">HSS2-Quality</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Role</label>
                    <select id="newRole" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" required>
                        <option value="engineer">Anggota</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <div class="flex justify-end space-x-4">
                    <button type="button" onclick="closeModal('addUserModal')" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50">Batal</button>
                    <button type="submit" class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700">Tambah</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Data Storage
        let users = JSON.parse(localStorage.getItem('hss2_users')) || [
            { username: 'admin', password: 'admin123', division: 'HSS2-Mechanical', role: 'admin', status: 'active' }
        ];
        let ebooks = JSON.parse(localStorage.getItem('hss2_ebooks')) || [];
        let documentation = JSON.parse(localStorage.getItem('hss2_documentation')) || [];
        let activities = JSON.parse(localStorage.getItem('hss2_activities')) || [];
        let currentUser = null;

        // Initialize
        window.onload = function() {
            setTimeout(() => {
                document.getElementById('loadingScreen').style.display = 'none';
            }, 1000);
        };

        // Login Functions
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            const user = users.find(u => u.username === username && u.password === password);
            if (user) {
                currentUser = user;
                document.getElementById('currentUser').textContent = user.username;
                document.getElementById('currentDivision').textContent = user.division;
                
                if (user.role === 'admin') {
                    document.getElementById('adminMenu').style.display = 'block';
                }
                
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                showDashboard();
                addActivity(user.username, user.division, 'Login ke sistem');
            } else {
                showNotification('Username atau password salah!', 'error');
            }
        });

        // Registration Functions
        document.getElementById('registrationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('regUsername').value;
            const password = document.getElementById('regPassword').value;
            const division = document.getElementById('regDivision').value;
            
            if (users.find(u => u.username === username)) {
                showNotification('Username sudah terdaftar!', 'error');
                return;
            }
            
            const newUser = {
                username: username,
                password: password,
                division: division,
                role: 'engineer',
                status: 'active'
            };
            
            users.push(newUser);
            localStorage.setItem('hss2_users', JSON.stringify(users));
            
            // Create division folder (simulated)
            if (!localStorage.getItem(`div_${division}`)) {
                localStorage.setItem(`div_${division}`, JSON.stringify([]));
            }
            
            showNotification('Registrasi berhasil! Silakan login.', 'success');
            showLogin();
            this.reset();
        });

        function showRegistration() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registrationScreen').classList.remove('hidden');
        }

        function showLogin() {
            document.getElementById('registrationScreen').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
        }

        // Navigation Functions
        function showDashboard() {
            hideAllContent();
            document.getElementById('dashboardContent').classList.remove('hidden');
            updateDashboardStats();
            updateRecentActivities();
        }

        function showEbooks() {
            hideAllContent();
            document.getElementById('ebooksContent').classList.remove('hidden');
            displayEbooks();
        }

        function showDocumentation() {
            hideAllContent();
            document.getElementById('documentationContent').classList.remove('hidden');
            displayDocumentation();
        }

        function showActivities() {
            hideAllContent();
            document.getElementById('activitiesContent').classList.remove('hidden');
            displayActivities();
        }

        function showUserManagement() {
            hideAllContent();
            document.getElementById('userManagementContent').classList.remove('hidden');
            displayUsers();
        }

        function hideAllContent() {
            document.getElementById('dashboardContent').classList.add('hidden');
            document.getElementById('ebooksContent').classList.add('hidden');
            document.getElementById('documentationContent').classList.add('hidden');
            document.getElementById('activitiesContent').classList.add('hidden');
            document.getElementById('userManagementContent').classList.add('hidden');
        }

        // Dashboard Functions
        function updateDashboardStats() {
            document.getElementById('totalEngineers').textContent = users.length;
            document.getElementById('totalEbooks').textContent = ebooks.length;
            document.getElementById('totalDocs').textContent = documentation.length;
            
            const divisions = [...new Set(users.map(u => u.division))];
            document.getElementById('totalDivisions').textContent = divisions.length;
        }

        function updateRecentActivities() {
            const recentActivities = activities.slice(-5).reverse();
            const container = document.getElementById('recentActivities');
            container.innerHTML = '';
            
            recentActivities.forEach(activity => {
                const div = document.createElement('div');
                div.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg';
                div.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-circle text-xs text-blue-600 mr-3"></i>
                        <div>
                            <p class="text-sm font-medium text-gray-800">${activity.user}</p>
                            <p class="text-xs text-gray-600">${activity.action}</p>
                        </div>
                    </div>
                    <span class="text-xs text-gray-500">${formatDate(activity.date)}</span>
                `;
                container.appendChild(div);
            });
        }

        // Ebook Functions
        function showCreateEbook() {
            document.getElementById('createEbookModal').classList.remove('hidden');
        }

        document.getElementById('createEbookForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const title = document.getElementById('ebookTitle').value;
            const category = document.getElementById('ebookCategory').value;
            const description = document.getElementById('ebookDescription').value;
            const file = document.getElementById('ebookFile').files[0];
            
            const ebook = {
                id: Date.now(),
                title: title,
                category: category,
                description: description,
                author: currentUser.username,
                division: currentUser.division,
                fileName: file.name,
                fileSize: formatFileSize(file.size),
                date: new Date().toISOString()
            };
            
            ebooks.push(ebook);
            localStorage.setItem('hss2_ebooks', JSON.stringify(ebooks));
            
            addActivity(currentUser.username, currentUser.division, `Membuat ebook: ${title}`);
            showNotification('Ebook berhasil dibuat!', 'success');
            closeModal('createEbookModal');
            this.reset();
            displayEbooks();
        });

        function displayEbooks() {
            const container = document.getElementById('ebooksList');
            container.innerHTML = '';
            
            ebooks.forEach(ebook => {
                const div = document.createElement('div');
                div.className = 'file-card bg-white rounded-xl shadow-md p-6 cursor-pointer';
                div.innerHTML = `
                    <div class="flex items-start justify-between mb-4">
                        <i class="fas fa-file-word text-4xl text-blue-600"></i>
                        <span class="text-xs text-gray-500">${formatDate(ebook.date)}</span>
                    </div>
                    <h3 class="font-bold text-gray-800 mb-2">${ebook.title}</h3>
                    <p class="text-sm text-gray-600 mb-3">${ebook.description}</p>
                    <div class="flex items-center justify-between text-xs text-gray-500">
                        <span><i class="fas fa-user mr-1"></i>${ebook.author}</span>
                        <span><i class="fas fa-building mr-1"></i>${ebook.division}</span>
                    </div>
                    <div class="mt-4 flex space-x-2">
                        <button onclick="downloadEbook(${ebook.id})" class="flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition duration-200 text-sm">
                            <i class="fas fa-download mr-1"></i>Download
                        </button>
                        ${currentUser.role === 'admin' || currentUser.username === ebook.author ? `
                            <button onclick="deleteEbook(${ebook.id})" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition duration-200 text-sm">
                                <i class="fas fa-trash"></i>
                            </button>
                        ` : ''}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function downloadEbook(id) {
            const ebook = ebooks.find(e => e.id === id);
            if (ebook) {
                addActivity(currentUser.username, currentUser.division, `Mengunduh ebook: ${ebook.title}`);
                showNotification(`Mengunduh ${ebook.fileName}...`, 'info');
            }
        }

        function deleteEbook(id) {
            if (confirm('Apakah Anda yakin ingin menghapus ebook ini?')) {
                const index = ebooks.findIndex(e => e.id === id);
                if (index > -1) {
                    const ebook = ebooks[index];
                    ebooks.splice(index, 1);
                    localStorage.setItem('hss2_ebooks', JSON.stringify(ebooks));
                    addActivity(currentUser.username, currentUser.division, `Menghapus ebook: ${ebook.title}`);
                    showNotification('Ebook berhasil dihapus!', 'success');
                    displayEbooks();
                }
            }
        }

        // Documentation Functions
        function showUploadDoc() {
            document.getElementById('uploadDocModal').classList.remove('hidden');
        }

        document.getElementById('uploadDocForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const title = document.getElementById('docTitle').value;
            const division = document.getElementById('docDivision').value;
            const description = document.getElementById('docDescription').value;
            const file = document.getElementById('docFile').files[0];
            
            const doc = {
                id: Date.now(),
                title: title,
                division: division,
                description: description,
                uploader: currentUser.username,
                fileName: file.name,
                fileSize: formatFileSize(file.size),
                fileType: file.type,
                date: new Date().toISOString()
            };
            
            documentation.push(doc);
            localStorage.setItem('hss2_documentation', JSON.stringify(documentation));
            
            // Add to division folder (simulated)
            const divDocs = JSON.parse(localStorage.getItem(`div_${division}`)) || [];
            divDocs.push(doc);
            localStorage.setItem(`div_${division}`, JSON.stringify(divDocs));
            
            addActivity(currentUser.username, division, `Mengupload dokumentasi: ${title}`);
            showNotification('Dokumentasi berhasil diupload!', 'success');
            closeModal('uploadDocModal');
            this.reset();
            displayDocumentation();
        });

        function displayDocumentation() {
            const filter = document.getElementById('divisionFilter').value;
            const container = document.getElementById('documentationList');
            container.innerHTML = '';
            
            const filteredDocs = filter ? documentation.filter(d => d.division === filter) : documentation;
            
            filteredDocs.forEach(doc => {
                const div = document.createElement('div');
                div.className = 'file-card bg-white rounded-xl shadow-md p-6';
                
                let icon = 'fa-file';
                if (doc.fileType.includes('pdf')) icon = 'fa-file-pdf';
                else if (doc.fileType.includes('word')) icon = 'fa-file-word';
                else if (doc.fileType.includes('image')) icon = 'fa-file-image';
                
                div.innerHTML = `
                    <div class="text-center mb-4">
                        <i class="fas ${icon} text-5xl text-purple-600"></i>
                    </div>
                    <h3 class="font-bold text-gray-800 mb-2 text-center">${doc.title}</h3>
                    <p class="text-sm text-gray-600 mb-3 text-center">${doc.description}</p>
                    <div class="space-y-1 text-xs text-gray-500">
                        <p class="text-center"><i class="fas fa-building mr-1"></i>${doc.division}</p>
                        <p class="text-center"><i class="fas fa-user mr-1"></i>${doc.uploader}</p>
                        <p class="text-center"><i class="fas fa-hdd mr-1"></i>${doc.fileSize}</p>
                    </div>
                    <div class="mt-4 flex space-x-2">
                        <button onclick="downloadDoc(${doc.id})" class="flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition duration-200 text-sm">
                            <i class="fas fa-download mr-1"></i>Download
                        </button>
                        ${currentUser.role === 'admin' || currentUser.username === doc.uploader ? `
                            <button onclick="deleteDoc(${doc.id})" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition duration-200 text-sm">
                                <i class="fas fa-trash"></i>
                            </button>
                        ` : ''}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function filterDocumentation() {
            displayDocumentation();
        }

        function downloadDoc(id) {
            const doc = documentation.find(d => d.id === id);
            if (doc) {
                addActivity(currentUser.username, doc.division, `Mengunduh dokumentasi: ${doc.title}`);
                showNotification(`Mengunduh ${doc.fileName}...`, 'info');
            }
        }

        function deleteDoc(id) {
            if (confirm('Apakah Anda yakin ingin menghapus dokumentasi ini?')) {
                const index = documentation.findIndex(d => d.id === id);
                if (index > -1) {
                    const doc = documentation[index];
                    documentation.splice(index, 1);
                    localStorage.setItem('hss2_documentation', JSON.stringify(documentation));
                    
                    // Remove from division folder (simulated)
                    const divDocs = JSON.parse(localStorage.getItem(`div_${doc.division}`)) || [];
                    const divIndex = divDocs.findIndex(d => d.id === id);
                    if (divIndex > -1) {
                        divDocs.splice(divIndex, 1);
                        localStorage.setItem(`div_${doc.division}`, JSON.stringify(divDocs));
                    }
                    
                    addActivity(currentUser.username, doc.division, `Menghapus dokumentasi: ${doc.title}`);
                    showNotification('Dokumentasi berhasil dihapus!', 'success');
                    displayDocumentation();
                }
            }
        }

        // Activities Functions
        function displayActivities() {
            const tbody = document.getElementById('activitiesTable');
            tbody.innerHTML = '';
            
            activities.slice().reverse().forEach(activity => {
                const tr = document.createElement('tr');
                tr.className = 'border-b hover:bg-gray-50';
                tr.innerHTML = `
                    <td class="py-3 px-4">${formatDate(activity.date)}</td>
                    <td class="py-3 px-4">${activity.user}</td>
                    <td class="py-3 px-4">${activity.division}</td>
                    <td class="py-3 px-4">${activity.action}</td>
                    <td class="py-3 px-4">
                        <span class="px-2 py-1 text-xs rounded-full ${getActivityBadgeClass(activity.action)}">
                            ${getActivityType(activity.action)}
                        </span>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function addActivity(user, division, action) {
            const activity = {
                user: user,
                division: division,
                action: action,
                date: new Date().toISOString()
            };
            activities.push(activity);
            localStorage.setItem('hss2_activities', JSON.stringify(activities));
        }

        function getActivityBadgeClass(action) {
            if (action.includes('Login')) return 'bg-green-100 text-green-800';
            if (action.includes('Membuat') || action.includes('Mengupload')) return 'bg-blue-100 text-blue-800';
            if (action.includes('Mengunduh')) return 'bg-purple-100 text-purple-800';
            if (action.includes('Menghapus')) return 'bg-red-100 text-red-800';
            return 'bg-gray-100 text-gray-800';
        }

        function getActivityType(action) {
            if (action.includes('Login')) return 'Login';
            if (action.includes('Membuat') || action.includes('Mengupload')) return 'Create';
            if (action.includes('Mengunduh')) return 'Download';
            if (action.includes('Menghapus')) return 'Delete';
            return 'Other';
        }

        // User Management Functions
        function showAddUser() {
            document.getElementById('addUserModal').classList.remove('hidden');
        }

        document.getElementById('addUserForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('newUsername').value;
            const password = document.getElementById('newPassword').value;
            const division = document.getElementById('newDivision').value;
            const role = document.getElementById('newRole').value;
            
            if (users.find(u => u.username === username)) {
                showNotification('Username sudah terdaftar!', 'error');
                return;
            }
            
            const newUser = {
                username: username,
                password: password,
                division: division,
                role: role,
                status: 'active'
            };
            
            users.push(newUser);
            localStorage.setItem('hss2_users', JSON.stringify(users));
            
            addActivity(currentUser.username, currentUser.division, `Menambahkan user: ${username}`);
            showNotification('User berhasil ditambahkan!', 'success');
            closeModal('addUserModal');
            this.reset();
            displayUsers();
        });

        function displayUsers() {
            const tbody = document.getElementById('usersTable');
            tbody.innerHTML = '';
            
            users.forEach(user => {
                const tr = document.createElement('tr');
                tr.className = 'border-b hover:bg-gray-50';
                tr.innerHTML = `
                    <td class="py-3 px-4">${user.username}</td>
                    <td class="py-3 px-4">${user.division}</td>
                    <td class="py-3 px-4">
                        <span class="px-2 py-1 text-xs rounded-full ${user.role === 'admin' ? 'bg-purple-100 text-purple-800' : 'bg-blue-100 text-blue-800'}">
                            ${user.role === 'admin' ? 'Admin' : 'Anggota'}
                        </span>
                    </td>
                    <td class="py-3 px-4">
                        <span class="px-2 py-1 text-xs rounded-full ${user.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${user.status}
                        </span>
                    </td>
                    <td class="py-3 px-4">
                        <button onclick="toggleUserStatus('${user.username}')" class="text-blue-600 hover:text-blue-700 mr-3">
                            <i class="fas fa-toggle-${user.status === 'active' ? 'on' : 'off'}"></i>
                        </button>
                        <button onclick="deleteUser('${user.username}')" class="text-red-600 hover:text-red-700">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function toggleUserStatus(username) {
            const user = users.find(u => u.username === username);
            if (user && user.username !== 'admin') {
                user.status = user.status === 'active' ? 'inactive' : 'active';
                localStorage.setItem('hss2_users', JSON.stringify(users));
                addActivity(currentUser.username, currentUser.division, `Mengubah status user: ${username}`);
                showNotification(`Status user ${username} berhasil diubah!`, 'success');
                displayUsers();
            }
        }

        function deleteUser(username) {
            if (username === 'admin') {
                showNotification('Tidak dapat menghapus user admin!', 'error');
                return;
            }
            
            if (confirm('Apakah Anda yakin ingin menghapus user ini?')) {
                const index = users.findIndex(u => u.username === username);
                if (index > -1) {
                    users.splice(index, 1);
                    localStorage.setItem('hss2_users', JSON.stringify(users));
                    addActivity(currentUser.username, currentUser.division, `Menghapus user: ${username}`);
                    showNotification('User berhasil dihapus!', 'success');
                    displayUsers();
                }
            }
        }

        // Utility Functions
        function logout() {
            if (currentUser) {
                addActivity(currentUser.username, currentUser.division, 'Logout dari sistem');
            }
            currentUser = null;
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('loginForm').reset();
            document.getElementById('adminMenu').style.display = 'none';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white z-50 fade-in ${
                type === 'success' ? 'bg-green-600' : 
                type === 'error' ? 'bg-red-600' : 
                'bg-blue-600'
            }`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas ${
                        type === 'success' ? 'fa-check-circle' : 
                        type === 'error' ? 'fa-exclamation-circle' : 
                        'fa-info-circle'
                    } mr-2"></i>
                    ${message}
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', { 
                day: '2-digit', 
                month: 'short', 
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('bg-black')) {
                event.target.classList.add('hidden');
            }
        }
    </script>
</body>
</html>
